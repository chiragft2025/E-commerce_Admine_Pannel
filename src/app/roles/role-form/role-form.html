<div class="form-card card shadow-sm p-4">

  <h2 class="mb-4">{{ isEdit ? 'Edit Role' : 'New Role' }}</h2>

  <form [formGroup]="form" (ngSubmit)="save()">

    <!-- Name -->
    <div class="mb-3">
      <label class="form-label">Name *</label>
      <input type="text" class="form-control" formControlName="name">
    </div>

    <!-- Permissions -->
    <h5 class="mb-3">Permissions</h5>

    <div *ngFor="let group of permissionEntries" class="mb-4">

      <!-- PARENT CHECKBOX -->
      <div class="d-flex align-items-center mb-2">
        <input
          type="checkbox"
          class="form-check-input me-2"
          [checked]="isModuleChecked(group.key)"
          (change)="toggleModule(group.key, $event.target.checked)"
        >
        <h6 class="fw-bold mb-0">{{ group.key }}</h6>
      </div>

      <!-- CHILD PERMISSIONS (NO VIEW SHOWN) -->
      <div class="row g-2">
        <div *ngFor="let perm of group.value" class="col-12 col-md-6 col-lg-4">
          <div class="d-flex align-items-start p-2 border rounded">
            <input
              type="checkbox"
              class="form-check-input me-2"
              [checked]="isChecked(perm.id)"
              (change)="togglePermission(perm.id, $event.target.checked, group.key)"
            >
            <label class="fw-semibold mb-0">{{ perm.action }}</label>
          </div>
        </div>
      </div>

      <hr>
    </div>

    <!-- Buttons -->
    <div class="d-flex justify-content-end gap-2">
      <button class="btn btn-primary" type="submit">{{ isEdit ? 'Update' : 'Create' }}</button>
      <button class="btn btn-outline-secondary" type="button" (click)="cancel()">Cancel</button>
    </div>

  </form>

</div>
