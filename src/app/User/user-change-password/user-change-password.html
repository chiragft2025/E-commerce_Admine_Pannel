<div class="container py-3" [attr.aria-busy]="loading">

  <!-- Loading -->
  <div *ngIf="loading" class="text-center my-4">
    <div class="spinner-border"></div>
  </div>

  <!-- Error message (EXPLAINS the red borders) -->
  <div *ngIf="error && !loading" class="alert alert-danger mb-3">
    {{ error }}
  </div>

  <div *ngIf="!loading" class="details-card card p-3 p-md-4">

    <div class="mb-2">
      <h2 class="h5 mb-1">Change Password</h2>
      <p class="text-muted small mb-0">
        Enter your current password and choose a new secure password.
      </p>
    </div>

    <form #f="ngForm" (ngSubmit)="submit()" novalidate>
      <div class="row g-3 mb-3">

        <!-- Current Password -->
        <div class="col-12">
          <label class="form-label">Current Password<span class="requried1">*</span></label>
          <input
            type="password"
            class="form-control"
            name="currentPassword"
            [(ngModel)]="model.currentPassword"
            #currentPwd="ngModel"
            required
            [class.is-invalid]="currentPwd.touched && currentPwd.invalid"
          />
        </div>

        <!-- New Password -->
        <div class="col-12 col-md-6">
          <label class="form-label">New Password<span class="requried1">*</span></label>
          <input
            type="password"
            class="form-control"
            name="newPassword"
            [(ngModel)]="model.newPassword"
            #newPwd="ngModel"
            required
            minlength="6"
            [class.is-invalid]="newPwd.touched && newPwd.invalid"
          />
        </div>

        <!-- Confirm Password -->
        <div class="col-12 col-md-6">
          <label class="form-label">Confirm Password<span class="requried1">*</span></label>
          <input
            type="password"
            class="form-control"
            name="confirmPassword"
            [(ngModel)]="model.confirmPassword"
            #confirmPwd="ngModel"
            required
            [class.is-invalid]="
              confirmPwd.touched &&
              (confirmPwd.invalid || model.newPassword !== model.confirmPassword)
            "
          />
        </div>

      </div>

      <div class="d-flex justify-content-end gap-2">
        <button type="button" class="btn btn-outline-secondary" routerLink="/">
          Cancel
        </button>

        <button type="submit" class="btn btn-primary">
          Change Password
        </button>
      </div>
    </form>
  </div>
</div>
